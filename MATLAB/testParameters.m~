% Parameters to adjust
densityTuningRange = 2:10;
histogramRange = 5:15;
videoRange = 78:120;

signTimes = [79:90 93:104 107:118];

[allFeatures, timeList] = compute3dHog(double(videoStack(:,:,videoRange)));
best = [0 0 -Inf];
for k1 = densityTuningRange
    for k2 = histogramRange
        motifs = findMotifClusters(allFeatures,k1);
        [counts chains] = findSequenceChains(motifs, allFeatures, k2, timeList, 5);
        correctTime = counts(signTimes,:);
        totalSignal = sum(counts(:));
        if sum(correctTime(:)) - totalSignal > best(3)
            best(3) = sum(correctTime(:)) - totalSignal;
            best(1) = k1;
            best(2) = k2;
            
        end
       
    end
    
end
